# 颜色系统

创建无障碍的个性化的颜色方案，并传达产品的层次(hierarchy)、状态(state)、形象(brand)

## 概述

材质颜色系统包括：
    - 内置无障碍颜色集
    - 26+对应组件的颜色定位(role)
    - 内置深色主题用的颜色
    - 针对默认颜色，具有可分配给不同颜色定位的静态基准颜色
    - 包含用户生成和基于内容的颜色在内的动态颜色特征

- 基准颜色方案不是动态的
- 动态颜色方案基于不同的输入（例如壁纸颜色）来改变界面的颜色
- 特定语义颜色可以被设置为不动态更改

利用动态颜色，产品可以自动生成合适的颜色并分配给各个UI。
它提供了：
- 个性化用户界面
- 可访问的对比度
- 用户控制的对比度
- 自动深色主题

## 颜色系统如何工作

1. 类似于数字填色
   - UI的每一个元素都有数字标识
   - 每个数字都有一个指定的颜色
   - 可以通过为每个数字自定义颜色来创建静态颜色方案
   - 也可以使用MD的动态颜色特征来为每个数字生成无障碍颜色
   - 可以通过以下手段来自定义动态颜色如何表现
     - 设置颜色来源
     - 添加静态或调和颜色
     - 改变元素分配的数字

2. 基本术语
   - 颜色定位（Color role）：对应特定的UI元素，具有类似于“原色(primary)”命名。不同的主题（深色/浅色）使用相同的颜色定位。
   - 动态颜色（Dynamic color）：依据壁纸或某个内容的颜色，即来源色（source color），创建出适用于各个元素的颜色方案，当来源色变化时，其他元素的颜色也会变化。动态颜色生成是全自动过程，由一个来源色生成5个关键色，再由5个来源色构建调色盘。然后调色盘的颜色被分配给颜色定位，颜色定位又被分配给UI元素。
   - 静态颜色（Static color）：不会随着依据的颜色变化而变化的颜色。可以手动选择，也可以使用设计工具生成（例如：[Material Theme Builder](https://www.figma.com/community/plugin/1034969338659738588/material-theme-builder)）。一旦设置给元素或者颜色定位，就固定为常量。
     - 基准颜色（Baseline color）：材质产品的默认静态颜色方案。同时包含深色和浅色主题。

3. 动态颜色生成配色方案
   1. 以来源色为开始。
    有三种方法获取来源色：
        - 从用户设置的设备壁纸生成：壁纸通过量化进行数字分析，并从中选取一个单色作为来源色
        - 从应用内嵌内容（图片、视频等）生成：内嵌内容同样通过量化进行数字分析，并从中选取一个单色作为来源色
        - 手动选取：由设计师精心挑选。基准颜色方案就是手动选取的。
    
   2. 来源色会被输入进一个算法
        动态颜色由MCU（Material Color Utilities）提供支持。MCU是一个颜色库的集合，包含算法与实用工具，来帮助开发者设计app的颜色主题和方案。
        主要使用以下三种算法：
       - 用户生成的颜色
            使用个人壁纸来识别源颜色。根据系统设计选择和用户偏好的组合，将特定色调（较浅或较暗）的颜色映射到方案中。

       - 调整基于内容的色调
            以匹配源图像的外观，同时保持可访问的对比度。

       - 自定义颜色
            颜色与所选的输入颜色（例如表示品牌或语义含义的颜色）紧密匹配。
   
   3. 算法生成关键色
        材质的颜色算法巧妙地处理源颜色的色调（hue）和色度（chroma）生成五种互补的关键色。这些关键色被称为：主要（Primary）、次要（Secondary）、第三（Tertiary）、素色（Neutral）、变体素色(Neutral variant)
   4. 创建色调调色板
        然后系统处理色调和色度，为每种关键色创建色调调色板。
        色调值越小，颜色越暗。
   5. 将色调分配给颜色定位
        算法使用颜色关系（accessible color relationships）来将特定的色调分配给26个颜色定位。
   6. 填入UI元素
   
4. 支持三种对比度
   通过无障碍色调调配定义的颜色关系，用户可以从以下三种级别的对比度选择最适合产品视觉的效果
    - 基本（Standard）：混合高低对比度，强调视觉层次结构
    - 中对比度（Medium）：适用于高对比度下视觉不适的人。但亮度提高时会产生光晕，使人感觉不适。
    - 高对比度（High）：减少视觉干扰，能使用户集中注意。
   对比度会自适应深浅主题。

   不属于材质组件库的自定义组件不会继承对比度更改。需要使自定义组件通过设计标志来维持相同的颜色定位。

5. 配对无障碍色调
    系统操作HCT值为每种颜色创建色调调色板，色调范围为 0 到 100。

    但是色彩有物理上的局限性，无论是实际的物理特性、我们自己的生物视觉局限性，还是屏幕显色性的局限性。例如，某些色调在某些色度或色调的情况下存在。颜色限制是亮浅蓝色或亮浅红色不太可能出现的原因。这就是为什么色调调色板中某些色调的色度值可能会增加或减少的原因。

    颜色算法使用这些调色板来查找和配对对比色调，从而创建无障碍的颜色组合。

    由于色调可以描述颜色的明暗，因此它用于定义可访问的颜色关系。这些关系内置于 Material 的颜色算法中。

6. 使用色相、色度和色调 （HCT） 定义颜色

    该系统使用称为 HCT 的色彩空间，它使用三个维度定义所有颜色：色调、色度和色调。

    通过更改 HCT 值，您可以灵活但可预测地操作颜色。与其他色彩空间（如 HSL 或 RGB）不同，HCT 允许在不影响其色调的情况下操纵颜色的色调和色度。    

    - 色相
        
        色相是对颜色的感知，如红色、橙色、黄色、绿色、蓝色、紫色等。色相由一个介于 0-360 之间的数字量化，是一个圆形光谱（值 0 和 360 是相同的色相）。
    
    - 色度
        
        色度是颜色的鲜艳或素净（黑白灰）的呈现方式。色度由从 0（完全灰色、黑色或白色）到无穷大（最鲜艳）的数字量化，HCT中的色度值最高约为120。

        由于生物和屏幕渲染的限制，不同的色调和不同的色相将具有不同的最大色度值。
    
    - 色凋
        
        色调是颜色的明暗程度。色调有时也称为亮度。色调由从 0（纯黑色，无亮度）到 100（纯白色，完整亮度）的数字量化。

        色调对于视觉可访问性至关重要，因为它决定了对比度。色调差异较大的颜色会产生较高的对比度，而差异较小的颜色会产生较低的对比度。
